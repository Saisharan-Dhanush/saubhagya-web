import{j as e,b2 as N,y as A,I as M,b1 as $,bu as _,bG as V,a1 as I,a$ as Y,a2 as z,bH as Q,o as K,K as W,g as J}from"./ui-vendor-CnKvLbpM.js";import{r as o}from"./react-vendor-XSK8c6JV.js";import{B as d,T as X,g as Z,h as H,i as T,C as u,f as p,b as v,c as C,e as S,d as f,P as ee,S as F,L as l,I as j,j as se,A as ae,a as te}from"./index-Cwg1D4Xy.js";import{C as m,Q as R,P as D}from"./Purification.config-BxofNtUh.js";import"./utils-Bj4fnUCk.js";import"./charts-D-uCZeDt.js";const oe=()=>{const[y,b]=o.useState([]),[r,x]=o.useState(null),[i,g]=o.useState({ch4Percentage:0,pressure:0,temperature:0,h2sLevel:0}),[c,h]=o.useState({targetCH4:95,sourceBatches:[],estimatedDuration:m.standard,operatorNotes:"",priority:"normal"}),[E,L]=o.useState([]);o.useEffect(()=>{const s=[{id:"cycle-001",batchId:"BATCH-2024-001",startTime:new Date(Date.now()-27e5),duration:60,status:"running",preCH4Reading:88.5,targetCH4:95,sourceUnits:["unit-1","unit-2"],operatorId:"OP001",qualityGrade:"B",pesoCompliant:!0,notes:"Standard purification cycle"},{id:"cycle-002",batchId:"BATCH-2024-002",startTime:new Date(Date.now()-12e5),duration:90,status:"running",preCH4Reading:90.2,targetCH4:96,sourceUnits:["unit-3"],operatorId:"OP002",qualityGrade:"A",pesoCompliant:!0,notes:"Extended cycle for premium grade"},{id:"cycle-003",batchId:"BATCH-2024-003",startTime:new Date(Date.now()-6e5),duration:45,status:"paused",preCH4Reading:87.1,targetCH4:92,sourceUnits:["unit-2"],operatorId:"OP001",qualityGrade:"B",pesoCompliant:!1,notes:"Rapid cycle - paused for maintenance"}],a=[{id:"cycle-h001",batchId:"BATCH-2024-H001",startTime:new Date(Date.now()-4*60*60*1e3),endTime:new Date(Date.now()-3*60*60*1e3),duration:60,status:"completed",preCH4Reading:89.5,postCH4Reading:95.8,targetCH4:95,sourceUnits:["unit-1"],outputVolume:1250,efficiency:94.2,operatorId:"OP003",qualityGrade:"A",pesoCompliant:!0,notes:"Excellent results achieved"},{id:"cycle-h002",batchId:"BATCH-2024-H002",startTime:new Date(Date.now()-6*60*60*1e3),endTime:new Date(Date.now()-5*60*60*1e3),duration:45,status:"failed",preCH4Reading:85.2,postCH4Reading:88.1,targetCH4:95,sourceUnits:["unit-2"],efficiency:68.5,operatorId:"OP001",qualityGrade:"FAILED",pesoCompliant:!1,notes:"Equipment malfunction detected"}];b(s),L(a),x(s[0])},[]);const U=(s,a)=>{const n=Math.floor((Date.now()-s.getTime())/6e4),t=Math.max(0,a-n),O=Math.min(100,n/a*100),k=Math.floor(t/60),q=t%60;return{elapsed:n,remaining:t,progress:O,display:`${k}h ${q}m remaining`}},B=s=>{let a=0;for(const n of D)if(a+=n.duration,s<=a/60*100)return n;return D[D.length-1]},G=()=>{const s={id:`cycle-${Date.now()}`,batchId:`BATCH-${new Date().getFullYear()}-${String(Date.now()).slice(-3)}`,startTime:new Date,duration:c.estimatedDuration,status:"running",preCH4Reading:i.ch4Percentage||0,targetCH4:c.targetCH4,sourceUnits:["unit-1"],operatorId:"CURRENT_USER",qualityGrade:"B",pesoCompliant:!0,notes:c.operatorNotes};b(a=>[...a,s]),x(s),h({targetCH4:95,sourceBatches:[],estimatedDuration:m.standard,operatorNotes:"",priority:"normal"})},w=(s,a)=>{b(n=>n.map(t=>{if(t.id===s)switch(a){case"pause":return{...t,status:"paused"};case"resume":return{...t,status:"running"};case"stop":return{...t,status:"completed",endTime:new Date};default:return t}return t}))},P=s=>{switch(s){case"running":return"bg-green-100 text-green-800";case"paused":return"bg-yellow-100 text-yellow-800";case"completed":return"bg-blue-100 text-blue-800";case"failed":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Cycle Management"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Monitor and control purification cycles"})]}),e.jsxs(d,{onClick:()=>x(null),className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(N,{className:"w-4 h-4 mr-2"}),"New Cycle"]})]}),e.jsxs(X,{defaultValue:"active",className:"w-full",children:[e.jsxs(Z,{className:"grid w-full grid-cols-3",children:[e.jsxs(H,{value:"active",children:["Active Cycles (",y.length,")"]}),e.jsx(H,{value:"new",children:"Start New Cycle"}),e.jsx(H,{value:"history",children:"Cycle History"})]}),e.jsx(T,{value:"active",className:"space-y-4",children:y.length===0?e.jsx(u,{children:e.jsxs(p,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(A,{className:"h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Active Cycles"}),e.jsx("p",{className:"text-gray-500 text-center mb-4",children:"Start a new purification cycle to begin processing biogas batches"}),e.jsx(d,{onClick:()=>x(null),variant:"outline",children:"Start New Cycle"})]})}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx("div",{className:"space-y-4",children:y.map(s=>{const a=U(s.startTime,s.duration),n=B(a.progress);return e.jsxs(u,{className:`cursor-pointer transition-shadow ${r?.id===s.id?"ring-2 ring-blue-500":""}`,onClick:()=>x(s),children:[e.jsx(v,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(C,{className:"text-lg",children:s.batchId}),e.jsxs(S,{children:["Target: ",s.targetCH4,"% CH₄"]})]}),e.jsx(f,{className:P(s.status),children:s.status})]})}),e.jsxs(p,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Progress"}),e.jsxs("span",{className:"font-medium",children:[a.progress.toFixed(1),"%"]})]}),e.jsx(ee,{value:a.progress,className:"h-2"}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[e.jsxs("span",{children:["Current: ",n.name]}),e.jsx("span",{children:a.display})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Pre-CH₄:"}),e.jsxs("span",{className:"ml-1 font-medium",children:[s.preCH4Reading,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Units:"}),e.jsx("span",{className:"ml-1 font-medium",children:s.sourceUnits.join(", ")})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(M,{className:"w-4 h-4 text-gray-400"}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Started ",s.startTime.toLocaleTimeString()]})]}),e.jsxs("div",{className:"flex space-x-2",children:[s.status==="running"&&e.jsx(d,{size:"sm",variant:"outline",onClick:t=>{t.stopPropagation(),w(s.id,"pause")},children:e.jsx($,{className:"w-3 h-3"})}),s.status==="paused"&&e.jsx(d,{size:"sm",variant:"outline",onClick:t=>{t.stopPropagation(),w(s.id,"resume")},children:e.jsx(N,{className:"w-3 h-3"})}),e.jsx(d,{size:"sm",variant:"outline",onClick:t=>{t.stopPropagation(),w(s.id,"stop")},children:e.jsx(_,{className:"w-3 h-3"})})]})]})]})]},s.id)})}),r&&e.jsxs(u,{children:[e.jsx(v,{children:e.jsxs(C,{className:"flex items-center",children:[e.jsx(V,{className:"w-5 h-5 mr-2 text-blue-600"}),"Cycle Details: ",r.batchId]})}),e.jsxs(p,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium mb-3 flex items-center",children:[e.jsx(A,{className:"w-4 h-4 mr-2"}),"Live Readings"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-green-50 p-3 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-green-700",children:"CH₄ Level"}),e.jsx(I,{className:"w-4 h-4 text-green-600"})]}),e.jsxs("div",{className:"text-2xl font-bold text-green-900",children:[(r.preCH4Reading+Math.random()*2).toFixed(1),"%"]})]}),e.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-blue-700",children:"Pressure"}),e.jsx(Y,{className:"w-4 h-4 text-blue-600"})]}),e.jsxs("div",{className:"text-2xl font-bold text-blue-900",children:[(2.1+Math.random()*.2).toFixed(2)," bar"]})]}),e.jsxs("div",{className:"bg-orange-50 p-3 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-orange-700",children:"Temperature"}),e.jsx(z,{className:"w-4 h-4 text-orange-600"})]}),e.jsxs("div",{className:"text-2xl font-bold text-orange-900",children:[(37+Math.random()*2).toFixed(1),"°C"]})]}),e.jsxs("div",{className:"bg-purple-50 p-3 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-purple-700",children:"H₂S Level"}),e.jsx(Q,{className:"w-4 h-4 text-purple-600"})]}),e.jsxs("div",{className:"text-2xl font-bold text-purple-900",children:[(12+Math.random()*3).toFixed(1)," ppm"]})]})]})]}),e.jsx(F,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium",children:"Cycle Information"}),e.jsxs("div",{className:"grid grid-cols-1 gap-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Target CH₄:"}),e.jsxs("span",{className:"font-medium",children:[r.targetCH4,"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Source Units:"}),e.jsx("span",{className:"font-medium",children:r.sourceUnits.join(", ")})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Operator:"}),e.jsx("span",{className:"font-medium",children:r.operatorId})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"PESO Compliant:"}),e.jsx(f,{className:r.pesoCompliant?"bg-green-100 text-green-800":"bg-red-100 text-red-800",children:r.pesoCompliant?"Yes":"No"})]})]})]}),r.notes&&e.jsxs(e.Fragment,{children:[e.jsx(F,{}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Notes"}),e.jsx("p",{className:"text-sm text-gray-600 bg-gray-50 p-3 rounded",children:r.notes})]})]})]})]})]})}),e.jsx(T,{value:"new",className:"space-y-6",children:e.jsxs(u,{children:[e.jsxs(v,{children:[e.jsxs(C,{className:"flex items-center",children:[e.jsx(N,{className:"w-5 h-5 mr-2 text-green-600"}),"Start New Purification Cycle"]}),e.jsx(S,{children:"Configure parameters for a new biogas purification cycle"})]}),e.jsxs(p,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"font-medium flex items-center",children:[e.jsx(I,{className:"w-4 h-4 mr-2"}),"Pre-Treatment Readings"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"preCH4",children:"Current CH₄ Percentage"}),e.jsx(j,{id:"preCH4",type:"number",step:"0.1",min:"0",max:"100",value:i.ch4Percentage||"",onChange:s=>g(a=>({...a,ch4Percentage:parseFloat(s.target.value)||0})),placeholder:"Enter current CH₄ %"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"prePressure",children:"Pressure (bar)"}),e.jsx(j,{id:"prePressure",type:"number",step:"0.1",min:"0",value:i.pressure||"",onChange:s=>g(a=>({...a,pressure:parseFloat(s.target.value)||0})),placeholder:"Enter pressure"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"preTemp",children:"Temperature (°C)"}),e.jsx(j,{id:"preTemp",type:"number",step:"0.1",value:i.temperature||"",onChange:s=>g(a=>({...a,temperature:parseFloat(s.target.value)||0})),placeholder:"Enter temperature"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"preH2S",children:"H₂S Level (ppm)"}),e.jsx(j,{id:"preH2S",type:"number",step:"0.1",min:"0",value:i.h2sLevel||"",onChange:s=>g(a=>({...a,h2sLevel:parseFloat(s.target.value)||0})),placeholder:"Enter H₂S level"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"font-medium flex items-center",children:[e.jsx(K,{className:"w-4 h-4 mr-2"}),"Cycle Configuration"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"targetCH4",children:"Target CH₄ Percentage"}),e.jsx(j,{id:"targetCH4",type:"number",step:"0.1",min:"90",max:"98",value:c.targetCH4,onChange:s=>h(a=>({...a,targetCH4:parseFloat(s.target.value)||95}))})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"duration",children:"Estimated Duration (minutes)"}),e.jsxs("select",{id:"duration",className:"w-full p-2 border border-gray-300 rounded-md",value:c.estimatedDuration,onChange:s=>h(a=>({...a,estimatedDuration:parseInt(s.target.value)})),children:[e.jsx("option",{value:m.rapid,children:"Rapid (45 min)"}),e.jsx("option",{value:m.standard,children:"Standard (60 min)"}),e.jsx("option",{value:m.extended,children:"Extended (90 min)"}),e.jsx("option",{value:m.deep_clean,children:"Deep Clean (120 min)"})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"priority",children:"Priority Level"}),e.jsxs("select",{id:"priority",className:"w-full p-2 border border-gray-300 rounded-md",value:c.priority,onChange:s=>h(a=>({...a,priority:s.target.value})),children:[e.jsx("option",{value:"normal",children:"Normal"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"urgent",children:"Urgent"})]})]})]})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"notes",children:"Operator Notes (Optional)"}),e.jsx(se,{id:"notes",placeholder:"Add any specific instructions or observations...",value:c.operatorNotes,onChange:s=>h(a=>({...a,operatorNotes:s.target.value})),rows:3})]}),e.jsxs("div",{className:"space-y-4",children:[(!i.ch4Percentage||!i.pressure)&&e.jsxs(ae,{children:[e.jsx(W,{className:"h-4 w-4"}),e.jsx(te,{children:"Please enter pre-treatment readings before starting the cycle."})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(d,{variant:"outline",children:"Save as Draft"}),e.jsxs(d,{onClick:G,disabled:!i.ch4Percentage||!i.pressure,className:"bg-green-600 hover:bg-green-700",children:[e.jsx(N,{className:"w-4 h-4 mr-2"}),"Start Cycle"]})]})]})]})]})}),e.jsx(T,{value:"history",className:"space-y-4",children:e.jsxs(u,{children:[e.jsxs(v,{children:[e.jsxs(C,{className:"flex items-center",children:[e.jsx(J,{className:"w-5 h-5 mr-2 text-purple-600"}),"Cycle History"]}),e.jsx(S,{children:"View completed and failed purification cycles"})]}),e.jsx(p,{children:e.jsx("div",{className:"space-y-4",children:E.map(s=>e.jsxs("div",{className:"border rounded-lg p-4 hover:bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:s.batchId}),e.jsxs("p",{className:"text-sm text-gray-600",children:[s.startTime.toLocaleDateString()," at ",s.startTime.toLocaleTimeString()]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(f,{className:P(s.status),children:s.status}),e.jsxs(f,{className:`bg-${R[s.qualityGrade]?.color}-100 text-${R[s.qualityGrade]?.color}-800`,children:["Grade ",s.qualityGrade]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Pre-CH₄:"}),e.jsxs("span",{className:"ml-1 font-medium",children:[s.preCH4Reading,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Post-CH₄:"}),e.jsxs("span",{className:"ml-1 font-medium",children:[s.postCH4Reading||"N/A","%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Output:"}),e.jsxs("span",{className:"ml-1 font-medium",children:[s.outputVolume||"N/A"," L"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Efficiency:"}),e.jsxs("span",{className:"ml-1 font-medium",children:[s.efficiency||"N/A","%"]})]})]}),s.notes&&e.jsx("p",{className:"text-sm text-gray-600 mt-3 bg-gray-50 p-2 rounded",children:s.notes})]},s.id))})})]})})]})]})};export{oe as CycleManagement};
//# sourceMappingURL=CycleManagement-C3YrRLNe.js.map
