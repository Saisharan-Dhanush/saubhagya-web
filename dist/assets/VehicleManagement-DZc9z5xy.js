import{j as e,K as u,h as p,a3 as v,J as h,bl as b,y,u as J,bL as K,au as O,p as W,I as w,ba as G,_ as D,m as Q}from"./ui-vendor-CnKvLbpM.js";import{r as x}from"./react-vendor-XSK8c6JV.js";import{C as l,f as n,B as i,d as S}from"./index-Cwg1D4Xy.js";import{t as M}from"./mockDataService-DPeHm-bU.js";import"./utils-Bj4fnUCk.js";import"./charts-D-uCZeDt.js";const le=()=>{const[d,k]=x.useState([]),[C,L]=x.useState([]),[V,j]=x.useState(!0),[g,F]=x.useState(null),[X,T]=x.useState(null),[r,A]=x.useState("all");x.useEffect(()=>{(async()=>{try{j(!0);const[t,a]=await Promise.all([M.getVehicles(),M.getDrivers()]);t.success&&k(t.data),a.success&&L(a.data)}catch{F("Failed to load vehicle data")}finally{j(!1)}})()},[]);const $=s=>{const a={active:{color:"bg-green-500",label:"Active"},maintenance:{color:"bg-yellow-500",label:"Maintenance"},inactive:{color:"bg-gray-500",label:"Inactive"}}[s];return e.jsx(S,{className:`${a.color} text-white`,children:a.label})},R=s=>{const a={truck:{color:"bg-blue-500",label:"Truck"},van:{color:"bg-purple-500",label:"Van"},tanker:{color:"bg-orange-500",label:"Tanker"}}[s];return e.jsx(S,{variant:"outline",className:`${a.color} text-white border-0`,children:a.label})},I=s=>s?s>50?"bg-green-500":s>25?"bg-yellow-500":"bg-red-500":"bg-gray-400",z=s=>{if(!s)return"Unassigned";const t=C.find(a=>a.id===s);return t?t.name:"Unknown Driver"},B=s=>{if(!s)return null;const t=new Date,a=new Date(s),m=Math.ceil((a.getTime()-t.getTime())/(1e3*60*60*24));return m<0?{color:"text-red-600",label:"Overdue",icon:u}:m<=7?{color:"text-yellow-600",label:"Due Soon",icon:w}:{color:"text-green-600",label:"Scheduled",icon:h}},E=s=>new Date(s).toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"numeric"}),f=d.filter(s=>r==="all"||s.status===r),P=()=>{const s=d.length,t=d.filter(c=>c.status==="active").length,a=d.filter(c=>c.status==="maintenance").length,m=d.filter(c=>c.status==="inactive").length,U=new Date,H=d.filter(c=>{if(!c.maintenanceDue)return!1;const q=new Date(c.maintenanceDue),N=Math.ceil((q.getTime()-U.getTime())/(1e3*60*60*24));return N<=7&&N>=0}).length,_=d.filter(c=>(c.fuelLevel||0)<25).length;return{total:s,active:t,maintenance:a,inactive:m,maintenanceSoon:H,lowFuel:_}};if(V)return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Vehicle Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage fleet vehicles and maintenance schedules"})]}),e.jsx("div",{className:"animate-pulse space-y-4",children:Array.from({length:4}).map((s,t)=>e.jsx(l,{children:e.jsxs(n,{className:"pt-6",children:[e.jsx("div",{className:"h-4 bg-gray-300 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-4 bg-gray-300 rounded w-1/2"})]})},t))})]});if(g)return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Vehicle Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage fleet vehicles and maintenance schedules"})]}),e.jsx(l,{className:"border-red-200 bg-red-50",children:e.jsxs(n,{className:"pt-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-red-800",children:[e.jsx(u,{className:"h-5 w-5"}),e.jsx("span",{children:g})]}),e.jsx(i,{onClick:()=>window.location.reload(),className:"mt-4",variant:"outline",children:"Retry"})]})})]});const o=P();return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Vehicle Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage fleet vehicles and maintenance schedules"})]}),e.jsxs(i,{className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(p,{className:"w-4 h-4 mr-2"}),"Add Vehicle"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[e.jsx(l,{children:e.jsx(n,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Fleet"}),e.jsx("p",{className:"text-2xl font-bold",children:o.total})]}),e.jsx(v,{className:"h-8 w-8 text-blue-600"})]})})}),e.jsx(l,{children:e.jsx(n,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:o.active})]}),e.jsx(h,{className:"h-8 w-8 text-green-600"})]})})}),e.jsx(l,{children:e.jsx(n,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Maintenance"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:o.maintenance})]}),e.jsx(b,{className:"h-8 w-8 text-yellow-600"})]})})}),e.jsx(l,{children:e.jsx(n,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Inactive"}),e.jsx("p",{className:"text-2xl font-bold text-gray-600",children:o.inactive})]}),e.jsx(y,{className:"h-8 w-8 text-gray-600"})]})})}),e.jsx(l,{children:e.jsx(n,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Maintenance Due"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:o.maintenanceSoon})]}),e.jsx(J,{className:"h-8 w-8 text-orange-600"})]})})}),e.jsx(l,{children:e.jsx(n,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Low Fuel"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:o.lowFuel})]}),e.jsx(K,{className:"h-8 w-8 text-red-600"})]})})})]}),e.jsx(l,{children:e.jsx(n,{className:"pt-6",children:e.jsx("div",{className:"flex space-x-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Filter by Status"}),e.jsxs("select",{className:"border border-gray-300 rounded-md px-3 py-2",value:r,onChange:s=>A(s.target.value),children:[e.jsx("option",{value:"all",children:"All Vehicles"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"maintenance",children:"Under Maintenance"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]})})})}),e.jsxs("div",{className:"space-y-4",children:[f.map(s=>{const t=B(s.maintenanceDue),a=t?.icon||h;return e.jsx(l,{className:"hover:shadow-md transition-shadow",children:e.jsx(n,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between space-y-4 lg:space-y-0",children:[e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("h3",{className:"text-lg font-semibold",children:s.registrationNumber}),$(s.status),R(s.type)]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",s.id]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(O,{className:"h-4 w-4 text-gray-400"}),e.jsxs("span",{children:["Capacity: ",s.capacity,"kg"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(W,{className:"h-4 w-4 text-gray-400"}),e.jsxs("span",{children:["Driver: ",z(s.driverId)]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(w,{className:"h-4 w-4 text-gray-400"}),e.jsxs("span",{children:["Hours: ",s.operatingHours.start,"-",s.operatingHours.end]})]}),s.assignedRoute&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(G,{className:"h-4 w-4 text-gray-400"}),e.jsxs("span",{children:["Route: ",s.assignedRoute]})]})]}),s.currentLocation&&e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(D,{className:"h-4 w-4 text-gray-400 mt-0.5"}),e.jsx("span",{className:"text-sm text-gray-600",children:s.currentLocation.address})]}),s.fuelLevel!==void 0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Fuel Level"}),e.jsxs("span",{className:"font-medium",children:[s.fuelLevel,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${I(s.fuelLevel)}`,style:{width:`${s.fuelLevel}%`}})}),s.fuelLevel<25&&e.jsxs("div",{className:"flex items-center space-x-2 text-red-600",children:[e.jsx(u,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:"Low fuel level - refuel needed"})]})]}),s.maintenanceDue&&t&&e.jsxs("div",{className:`p-3 border rounded-lg ${t.color==="text-red-600"?"border-red-200 bg-red-50":t.color==="text-yellow-600"?"border-yellow-200 bg-yellow-50":"border-green-200 bg-green-50"}`,children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(a,{className:`h-4 w-4 ${t.color}`}),e.jsxs("span",{className:`text-sm font-medium ${t.color}`,children:["Maintenance ",t.label]})]}),e.jsxs("p",{className:`text-sm mt-1 ${t.color}`,children:["Due: ",E(s.maintenanceDue)]})]})]}),e.jsxs("div",{className:"flex flex-col space-y-2 min-w-[120px]",children:[e.jsxs(i,{variant:"outline",size:"sm",onClick:()=>T(s),children:[e.jsx(Q,{className:"w-4 h-4 mr-1"}),"Edit"]}),s.status==="active"&&e.jsxs(i,{variant:"outline",size:"sm",className:"text-yellow-600 hover:text-yellow-700",children:[e.jsx(b,{className:"w-4 h-4 mr-1"}),"Maintenance"]}),s.status==="maintenance"&&e.jsxs(i,{size:"sm",className:"bg-green-600 hover:bg-green-700",children:[e.jsx(h,{className:"w-4 h-4 mr-1"}),"Mark Active"]}),s.status==="inactive"&&e.jsxs(i,{size:"sm",className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(y,{className:"w-4 h-4 mr-1"}),"Activate"]}),e.jsxs(i,{variant:"outline",size:"sm",children:[e.jsx(D,{className:"w-4 h-4 mr-1"}),"Track"]})]})]})})},s.id)}),f.length===0&&e.jsx(l,{children:e.jsx(n,{className:"pt-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(v,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:r==="all"?"No vehicles found":`No ${r} vehicles`}),e.jsx("p",{className:"text-gray-500 mb-4",children:r==="all"?"No vehicles have been added to the fleet yet.":`There are no vehicles with ${r} status.`}),r==="all"&&e.jsxs(i,{className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(p,{className:"w-4 h-4 mr-2"}),"Add First Vehicle"]})]})})})]})]})};export{le as VehicleManagement,le as default};
//# sourceMappingURL=VehicleManagement-DZc9z5xy.js.map
